<div class="custom-container mt-2">
  <div class="post-header d-flex">
    <div class="img-container user-picture-round">
      <img [src]="post?.user?.profile?.image?.file_path || '/assets/images/mock_avatar.png'" alt="Profile Picture">
    </div>
    <div class="user-data">
<!--      TODO: ADD DEEPLINKS-->
      <div class="user-credentials pointer hover-secondary">
        {{ post.user.first_name }} {{ post.user.last_name }}
      </div>
      <div class="created-at pointer hover-primary">
        {{post.updated_at}}
      </div>
    </div>
  </div>
  <div class="post-body">
    <div class="post-content">
      {{post.content}}
    </div>
    <div class="post-img img-container pointer" *ngIf="post.image?.file_path">
      <img [src]="post.image?.file_path | safeUrl" alt="Post Picture">
    </div>
  </div>

  <div class="post-bar d-flex align-items-center justify-content-between">
    <div class="share-container d-flex align-items-center">
      <span class="mr-2 share-count">{{post.likes?.length || 0}}</span>
      <div class="actions hover-secondary" [class.shared]="isShared" (click)="onShareClick($event); toggleLike()">
        <span class="arrow-wrapper">
          <i class="fa-solid fa-arrow-up-long up" #upArrowRef></i>
          <i class="fa-solid fa-arrow-down-long down" #downArrowRef></i>
        </span>
      </div>
    </div>

    <div class="comment-count">
      {{post.comments?.length || 0}} comments
    </div>

  </div>

  <div class="comments-container">
    <div class="comment d-flex" *ngFor="let comment of post.comments">
      <div class="comment-container d-flex">
        <div class="comment-header">{{comment.user.first_name | titlecase}} {{comment.user.last_name | titlecase}}</div>

        <div class="img-container user-picture-round comment-picture">
          <img src="/assets/images/julka.JPG">
        </div>
        <div class="comment-body">
          <div class="comment-text">
            {{comment.content}}
          </div>

          <div class="comment-footer">
            <div class="vote-container">
              <span class="vote-icon hover-secondary"
                    [class.vote-active]="comment.voteState === voteState.UPVOTED"
                    (click)="handleVote(comment.id!, 1)">
                <i class="fa-solid fa-angle-up"></i>
              </span>

              <span class="vote-count ml-2 mr-2">{{comment.voteValue}}</span>

              <span class="vote-icon hover-secondary"
                    [class.vote-active]="comment.voteState === voteState.DOWNVOTED"
                    (click)="handleVote(comment.id!, -1)">
                <i class="fa-solid fa-angle-down"></i>
              </span>
            </div>

            <div class="sent-at-text">
              {{comment.created_at}}
            </div>

          </div>

        </div>
      </div>
    </div>
  </div>

  <div class="post-footer mt-4 d-flex">
    <div class="img-container user-picture-round comment-profile-picture">
      <img src="/assets/images/julka.JPG" alt="Your Profile Picture">
    </div>

    <div class="comment-body custom-contenteditable"
         contenteditable="true"
         data-placeholder="Aa"
         (keydown.enter)="$event.preventDefault(); addComment()"
         #commentBody>
    </div>

    <div class="comment-icon hover-secondary" (click)="addComment()">
      <i class="fa-solid fa-comment-dots"></i>
    </div>
  </div>
</div>


